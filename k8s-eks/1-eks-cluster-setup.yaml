piVersion: eksctl.io/v1alpha5
kind: ClusterConfig
metadata:
  name: rnd-cluster
  region: ap-south-1
  version: "1.33"
  tags:
    Environment: Dev
iam:
  withOIDC: true

vpc:
  cidr: 172.31.0.0/16
  clusterEndpoints:
    publicAccess: true   
    privateAccess: false 

availabilityZones:
  - ap-south-1a

managedNodeGroups:
  - name: ng-general
    instanceTypes: 
      - t3.medium 
    minSize: 1
    maxSize: 6
    desiredCapacity: 1
    volumeSize: 40 
    volumeType: gp3
    ssh:
      allow: true   
      publicKeyName: nasir-ttl
    tags:
      NodeGroup: General
      Environment: dev
    iam:
      attachPolicyARNs:
        - arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy
        - arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy
        - arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly
# iam:
#   withOIDC: true
#   podIdentityAssociations:
#   - namespace: kube-system
#     serviceAccountName: karpenter
#     roleName: karpenter-c1-karpenter
#     permissionPolicyARNs:
#     - arn:aws:iam::605134426044:policy/KarpenterControllerPolicy-karpenter-c1

# iamIdentityMappings:
# - arn: "arn:aws:iam::605134426044:role/KarpenterNodeRole-karpenter-c1"
#   username: system:node:{{EC2PrivateDNSName}}
#   groups:
#   - system:bootstrappers
#   - system:nodes